{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://curation.network/dapp-schema",

  "title": "DApp JSON Schema",
  "description": "JSON schema specification for describing DApps â€“ decentralized applications",
 
  "type": "object",
  "required": ["version", "metadata", "smartContracts"],

  "properties": {
    "version": {
	    "title": "Dapp version",

      "type": "object",
      "required": [
        "current"
      ],

      "properties": {
        "current": {
          "title": "Current version",
          "description": "Version of DApp specification. Semantic versioning is mandatory",
          "$ref": "#/definitions/semver"
        },

        "releaseNotes": {
          "title": "Release notes",
          "description": "Short description of major updates, link to details is recommended",
          "type": "string"
        },

        "previous": {
          "title": "Previous version",
          "description": "IPFS hash of previous DApp specification",
          "$ref": "#/definitions/ipfsHash"
        }
      }
    },

    "metadata": {
	    "title": "DApp metadata",
      "description": "Descriptional information about the DApp",

      "type": "object",
      "required": [
        "name"
      ],

      "properties": {
        "name": {
          "title": "Name",
          "description": "Official display name of the DApp",
		      "type": "string"
		    },

        "shortDescription": {
          "title": "Short description",
          "description": "Short description of the DApp (up to 80 characters)",
          "type": "string",
          "maxLength": 80
    		},

        "description": {
          "title": "Description",
          "description": "Full description of the DApp",
          "type": "string"
        },
        
        "categories": {
          "title": "Categories of Dapp",
          "type": "array",
          "minItems": 1,
          "items": {"type": "string"}
        },
    
        "tags": {
          "title": "Tags",
          "type": "array",
          "items": {
            "type": "string"
          },
          "uniqueItems": true
        },

        "website": {
          "title": "Website",
          "description": "Address of the official DApp website",
          "type": "string",
          "format": "uri"
        },

        "github": {
          "title": "GitHub link",
          "description": "Official GitHub page of project",
          "type": "string",
          "format": "uri"
        },

        "securityAudits": {
          "title": "Security audits",
          "description": "Links to security audit reports",
          "type": "array",
          "items": {
            "type": "string",
            "format": "uri"
          }
        },

        "logo": {
          "title": "Logo",
          "description": "IPFS hash of the DApp logo",
          "$ref": "#/definitions/ipfsHash"
        },

        "images": {
          "title": "Additional images",
          "description": "IPFS hashes of additional images fro DApp (screenshots, schemas, etc.)",
          "type": "array",
          "items": {
            "$ref": "#/definitions/ipfsHash"
          }
        }
      }
    },

    "smartContracts": {
      "title": "Smart contracts",
      "description": "Array of DApp smart contracts addresses",

      "type": "array",
      "minItems": 1,

      "items": {
        "type": "object",
        "required": [
          "network",
          "address"
        ],

        "properties": {
          "network": {
            "title": "Network",
            "$ref": "#/definitions/network"
          },

          "address": {
            "title": "Address",
            "$ref": "#/definitions/ethAddress"
          },

          "standards": {
            "title": "Supported ERC standards",
            "type": "array",
            "items": {
              "$ref": "#/definitions/standard"
            }
          }
        }  
      }
    }
  },

  "definitions": {
    "semver": {
      "$comment": "semantic versioning",
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$"
    },

    "ipfsHash": {
      "type": "string",
      "pattern": "^Qm[1-9A-HJ-NP-Za-km-z]{44}$"
    },

    "ethAddress": {
      "type": "string",
      "pattern": "^(?:0[Xx])?[0-9a-fA-F]{40}|[a-z0-9\\.]+\\.eth$"
    },

    "network": {
      "type": "integer",
      "enum": [1, 3, 4, 8, 42, 77, 99, 100, 401697, 7762959, 61717561],
      "default": 1
    },

    "standard": {
      "type": "integer",
      "enum": [20, 721]
    }
  }
}
